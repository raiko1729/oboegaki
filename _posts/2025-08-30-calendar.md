---
layout: post
title: "APIã‚’ç”¨ã„ã¦Googleã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã®ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—è‡ªå‹•åŒ–"
date: 2025-10-26
image: /assets/images/2025-10-26-icon.svg
tags: ["ã‚¿ã‚¹ã‚¯ç®¡ç†"]
---

![Discord_image](https://storage.googleapis.com/zenn-user-upload/ff686bdbd1b0-20251017.jpg)

## ã©ã‚“ãªã‚‚ã®ï¼Ÿ

Googleã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã®èª¬æ˜Žæ¬„ã«ãƒ¡ãƒ¢ã—ã¦ã‚ã‚‹ã¨ãï¼ŒDiscordã¸ã‚¿ã‚¤ãƒˆãƒ«ã¨ãƒ¡ãƒ¢å†…å®¹ã®é€šçŸ¥ã‚’ã—ã¦ãã‚Œã‚‹ï¼Ž


## ãªãœä½œã£ãŸã®ï¼Ÿ

èª¬æ˜Žæ¬„ã«ãƒ¡ãƒ¢ã‚’ã—ã¦ã‚‚ãã‚Œã‚’é€šçŸ¥ã™ã‚‹è¡“ãŒãªã„ï¼Ž
ã›ã£ã‹ãå¤§åˆ‡ãªã“ã¨ã‚’ãƒ¡ãƒ¢ã‚’ã—ã¦ã‚‚å¿˜ã‚Œã¦ã—ã¾ã†ã“ã¨ãŒå¤šã€…ã‚ã£ãŸï¼Ž

## ã—ãã¿

ä»¥ä¸‹ã®ã‚ˆã†ãªãƒ•ãƒ­ãƒ¼ãƒãƒ£ãƒ¼ãƒˆã«ãªã£ã¦ã„ã‚‹ï¼Ž
é»„è‰²ã®ç·šã§å›²ã£ãŸã¨ã“ãŒèª¬æ˜Žã‚ã‚Šâ†’é€šçŸ¥ã®ã‚·ã‚¹ãƒ†ãƒ ã«é–¢ã‚ã‚‹ç®‡æ‰€ã§ã‚ã‚‹ï¼Ž
![Googleã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼APIãƒ•ãƒ­ãƒ¼ãƒãƒ£ãƒ¼ãƒˆ](https://storage.googleapis.com/zenn-user-upload/f8611459f51a-20251016.png)
*å›³1: Googleã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼APIã¨Discordé€šçŸ¥ã®é–¢ä¿‚å›³ï¼ˆé»„è‰²ã®æž ãŒä»Šå›žã®å†…å®¹ï¼‰*

## Apps scriptã«æ›¸ã„ã¦ã‚ã‚‹ã‚³ãƒ¼ãƒ‰

Apps scriptã«ã¯ä»¥ä¸‹ã®to_discord_scriptãŒæ›¸ã‹ã‚Œã¦ã„ã‚‹ï¼Žã“ã“ãŒèª¬æ˜Žã‚ã‚Šâ†’é€šçŸ¥ã™ã‚‹ã¨ã„ã£ãŸã‚·ã‚¹ãƒ†ãƒ ã®æ ¹å¹¹ã§ã‚ã‚‹ï¼Ž

ãƒˆãƒªã‚¬ãƒ¼ã‚’ä½¿ã£ã¦ä¸€å®šæ™‚é–“ã”ã¨ã«ãã‚Œãžã‚Œã®é–¢æ•°ãŒèµ°ã£ã¦ã„ã‚‹ï¼Ž

### é–¢æ•°ã®èª¬æ˜Ž

- sendDiscordRemindersï¼š30åˆ†å¾Œã®èª¬æ˜Žã‚ã‚Šã®äºˆå®šã‚’èµ°æŸ»ã—ã¦ã„ã‚‹ï¼Žãƒˆãƒªã‚¬ãƒ¼ã§æ¯Žåˆ†å®Ÿè¡Œã—ã¦ã„ã‚‹ï¼Ž
- sendAllDayEventRemindersï¼šç¿Œæ—¥ã®èª¬æ˜Žã‚ã‚Šã®äºˆå®šã‚’èµ°æŸ»ã—ã¦ã„ã‚‹ï¼Žãƒˆãƒªã‚¬ãƒ¼ã§æ¯Žæ—¥17æ™‚ï½ž18æ™‚ã®ã©ã“ã‹ã§ãƒ©ãƒ³ãƒ€ãƒ ã«å®Ÿè¡Œã—ã¦ã„ã‚‹ï¼Ž

### ãƒˆãƒªã‚¬ãƒ¼ã®è¨­å®š

- `sendDiscordReminders` â†’ æ¯Žåˆ†ãƒˆãƒªã‚¬ãƒ¼
- `sendAllDayEventReminders` â†’ æ¯Žæ—¥17:00ã€œ18:00ã®é–“ã§å®Ÿè¡Œ

Apps Scriptã®ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‹ã‚‰ã€Œãƒˆãƒªã‚¬ãƒ¼ã€ã‚’é–‹ãï¼Œå¯¾å¿œã™ã‚‹é–¢æ•°ã«ä¸Šè¨˜ã®ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’è¨­å®šã™ã‚Œã°OKï¼Ž


ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆã‚’æ›¸ã„ã¦è»½ãèª¬æ˜Žã™ã‚‹ï¼Ž

```js
// Discord Webhook URLã“ã“ã¯è‡ªåˆ†ã§ã¨ã£ã¦ãã‚‹ï¼
const webhookUrl = "https://discordapp.com/api/...";

function sendDiscordReminders() {
  // ãƒ¡ã‚¤ãƒ³ã®Googleã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã‚’å–å¾—
  var calendar = CalendarApp.getDefaultCalendar();

  // ç¾åœ¨æ™‚åˆ»ã€œ30åˆ†å¾Œã¾ã§ã‚’ãƒã‚§ãƒƒã‚¯
  var now = new Date();
  var later = new Date(now.getTime() + 30 * 60 * 1000);
  var events = calendar.getEvents(now, later);

  // å¯¾è±¡ã®ã‚¤ãƒ™ãƒ³ãƒˆã”ã¨ã«é€šçŸ¥
  events.forEach(function(event) {

    // çµ‚æ—¥ã‚¤ãƒ™ãƒ³ãƒˆã¯ã‚¹ã‚­ãƒƒãƒ—
    if (event.isAllDayEvent()) return;

    var start = event.getStartTime();
    var diffMinutes = Math.floor((start.getTime() - now.getTime()) / 1000 / 60);
    var description = event.getDescription();

    // èª¬æ˜ŽãŒãªã„ã‚¤ãƒ™ãƒ³ãƒˆã¯ã‚¹ã‚­ãƒƒãƒ—
    if (!description || description.trim() === "") return;

    // ã¡ã‚‡ã†ã©30åˆ†å‰ã®ã¨ãã ã‘é€šçŸ¥
    if (diffMinutes >= 29 && diffMinutes <= 30) {
      var embed = {
        title: "â° 30åˆ†å¾Œã«èª¬æ˜Žã‚ã‚Šã®äºˆå®šãŒã‚ã‚Šã¾ã™ï¼",
        color: 3447003, //é’ðŸŸ¦
        fields: [
          {
            name: "ðŸ“Œ ã‚¿ã‚¤ãƒˆãƒ«",
            value: event.getTitle()
          },
          //æ™‚åˆ»ã¯30åˆ†å¾Œã£ã¦åˆ†ã‹ã£ã¦ã‚‹ã‹ã‚‰ã„ã‚‰ã‚“ã¨æ€ã£ã¦ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆã«ã—ã¦ã‚ã‚‹
          /*
          {
            name: "ðŸ•’ é–‹å§‹æ™‚åˆ»",
            value: start.toLocaleString()
          },
          */
          {
            name: "ðŸ“ èª¬æ˜Ž",
            value: description
          }
        ]
      };

      var payload = { embeds: [embed] };

      UrlFetchApp.fetch(webhookUrl, {
        method: "post",
        contentType: "application/json",
        payload: JSON.stringify(payload),
        muteHttpExceptions: true
      });
    }
  });
}


function sendAllDayEventReminders() {
  var calendar = CalendarApp.getDefaultCalendar();
  // ç¾åœ¨ã®æ—¥æ™‚ã‚’å–å¾—
  var now = new Date();

  // æ˜Žæ—¥ã®æ—¥ä»˜ã‚’å–å¾—ï¼ˆæ™‚åˆ»éƒ¨åˆ†ã¯0:00ï¼‰
  var tomorrow = new Date(now.getFullYear(), now.getMonth(), now.getDate() + 1);

  // æ˜Žæ—¥ã®çµ‚æ—¥ã‚¤ãƒ™ãƒ³ãƒˆã‚’å–å¾—
  var events = calendar.getEventsForDay(tomorrow);

  events.forEach(function(event) {
    // çµ‚æ—¥ã‚¤ãƒ™ãƒ³ãƒˆã®ã¿å¯¾è±¡
    if (!event.isAllDayEvent()) return;

    var description = event.getDescription();

    // èª¬æ˜ŽãŒãªã„ã‚¤ãƒ™ãƒ³ãƒˆã¯ã‚¹ã‚­ãƒƒãƒ—
    if (!description || description.trim() === "") return;

    // é€šçŸ¥ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®å†…å®¹
    var embed = {
      title: "ðŸŒ™ æ˜Žæ—¥ã¯èª¬æ˜Žã‚ã‚Šã®çµ‚æ—¥ã‚¤ãƒ™ãƒ³ãƒˆãŒã‚ã‚Šã¾ã™ï¼",
      color: 15844367, //é»„è‰²ðŸŸ¡
      fields: [
        {
          name: "ðŸ“Œ ã‚¿ã‚¤ãƒˆãƒ«",
          value: event.getTitle()
        },
        {
          name: "ðŸ“ èª¬æ˜Ž",
          value: description
        }
      ]
    };

    var payload = { embeds: [embed] };

    // Discordã«é€ä¿¡
    UrlFetchApp.fetch(webhookUrl, {
      method: "post",
      contentType: "application/json",
      payload: JSON.stringify(payload),
      muteHttpExceptions: true
    });
  });
}
```

## ãŠã—ã¾ã„

Discord webhook URLã‚’ã¡ã‚ƒã‚“ã¨å–ã£ã¦ï¼Œãƒˆãƒªã‚¬ãƒ¼ã‚’ã¡ã‚ƒã‚“ã¨è¨­å®šã—ãŸã‚‰ä¸Šæ‰‹ãå‹•ãã¯ãšï¼Ž
ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã®ã€Œèª¬æ˜Žæ¬„ã€ã‚’æ´»ã‹ã™ã“ã¨ã§ï¼Œã¡ã‚‡ã£ã¨ã—ãŸãƒ¡ãƒ¢ã‚’é€ƒã•ãªã„å¿«é©ãªãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã«ãªã‚‹ï¼Ž
**è‡ªå‹•åŒ–ã¯ã—ã‚ã‚ã›**